workflows:
  build_and_notify:
    name: Build APK and Send to Telegram
    max_build_duration: 30
    environment:
      flutter: "3.35.3"
      groups:
        - app  # ØªØ¶Ù…ÙŠÙ† Ù…Ø¬Ù…ÙˆØ¹Ø© environment variables
    triggering:
      events:
        - tag  # Ø¨Ù†Ø§Ø¡ Ø¹Ù†Ø¯ Ø¥Ù†Ø´Ø§Ø¡ Tag ÙÙ‚Ø·
      tag_patterns:
        - pattern: "v*"  # Ø£ÙŠ Tag ÙŠØ¨Ø¯Ø£ Ø¨Ù€ v (Ù…Ø«Ù„ v1.0.0)
          include: true
      cancel_previous_builds: true
    scripts:
      - name: Install dependencies
        script: flutter pub get

      - name: Build APK (split-per-abi)
        script: flutter build apk --split-per-abi

      - name: Send APK (armeabi-v7a) to Telegram (Group + Personal)
        script: |
          # Ø¥Ø±Ø³Ø§Ù„ Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©
          curl -F document=@build/app/outputs/flutter-apk/app-armeabi-v7a-release.apk \
               -F chat_id=-5183388304 \
               -F caption="âœ… APK (armeabi-v7a) Ø¬Ø§Ù‡Ø² Ù„Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© ğŸ”§" \
               https://api.telegram.org/bot$TELEGRAM_BOT_TOKEN/sendDocument
          
#          # Ø¥Ø±Ø³Ø§Ù„ Ø¥Ù„ÙŠÙƒ Ø´Ø®ØµÙŠÙ‹Ø§
#          curl -F document=@build/app/outputs/flutter-apk/app-armeabi-v7a-release.apk \
#               -F chat_id=939530041 \
#               -F caption="âœ… APK (armeabi-v7a) Ø¬Ø§Ù‡Ø² Ù„Ùƒ Ø´Ø®ØµÙŠÙ‹Ø§ ğŸ’Œ" \
#               https://api.telegram.org/bot$TELEGRAM_BOT_TOKEN/sendDocument

      - name: Send APK (arm64-v8a) to Telegram (Group + Personal)
        script: |
          # Ø¥Ø±Ø³Ø§Ù„ Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©
          curl -F document=@build/app/outputs/flutter-apk/app-arm64-v8a-release.apk \
               -F chat_id=-5183388304 \
               -F caption="âœ… APK (arm64-v8a) Ø¬Ø§Ù‡Ø² Ù„Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© ğŸš€" \
               https://api.telegram.org/bot$TELEGRAM_BOT_TOKEN/sendDocument

#          # Ø¥Ø±Ø³Ø§Ù„ Ø¥Ù„ÙŠÙƒ Ø´Ø®ØµÙŠÙ‹Ø§
#          curl -F document=@build/app/outputs/flutter-apk/app-arm64-v8a-release.apk \
#               -F chat_id=939530041 \
#               -F caption="âœ… APK (arm64-v8a) Ø¬Ø§Ù‡Ø² Ù„Ùƒ Ø´Ø®ØµÙŠÙ‹Ø§ ğŸ’Œ" \
#               https://api.telegram.org/bot$TELEGRAM_BOT_TOKEN/sendDocument
